<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Data Cleaning/Data Development</title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: #990073
   }

   pre .number {
     color: #099;
   }

   pre .comment {
     color: #998;
     font-style: italic
   }

   pre .keyword {
     color: #900;
     font-weight: bold
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: #d14;
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>



<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<h2>Data Cleaning/Data Development</h2>

<p>Load libraries</p>

<pre><code class="r">   library(dplyr) # for data manipulation
   options(width=160)
</code></pre>

<p>Purpose:  to read in raw data from Karen&#39;s excel spradsheet, &ldquo;Karen&#39;s work Copy of g1288 results.xls&rdquo;, 
look at a few data summaries, and check for errors.</p>

<p>Read in raw data on samples and individuals tab (saved as .csv files)</p>

<pre><code class="r">  ind&lt;-read.csv(&quot;../data/Individuals2.csv&quot;)
  head(ind)
</code></pre>

<pre><code>##   Individual Sex no_Samples Loci CXX20   G1D  G10M MSUT2  MU50  G10X  G10P REN144.A06   G1A  G10C   D1A  G10J  G10L  CPH9 CXX110  D123  MU26  G10U  MU59
## 1         56   F         65   24 123.1 176.2 214.2 205.2 134.1 133.1 163.2      129.1 194.2 209.2 157.2 207.2 137.2 143.1  155.2 141.1 183.2 179.2 233.2
## 2       1435   F          1   24 123.1 172.2 208.2 205.2 132.1 147.1 163.2      125.1 194.2 215.2 167.2 187.2 137.1 143.1  155.2 143.1 185.2 175.2 233.2
## 3       2213   F        117   24 135.1 174.2 206.2 197.2 120.1 141.1 153.2      121.1 198.2 205.2 157.2 187.2 137.1 143.1  137.2 145.2 185.2 179.2 231.2
## 4       3002   F         26   24 135.1 174.2 206.2 197.2 120.1 141.2 153.2      119.1 196.2 205.2 163.2 203.2 137.1 143.1  137.2 155.2 185.2 177.2 231.2
## 5       3101   M          1   24 123.1 172.2 208.2 197.2 120.1 141.1 151.2      119.1 194.2 215.2 175.2 187.2 137.2 149.2  157.2 141.1 185.2 175.2 233.2
## 6       3103   F          1   24 123.1 172.2 208.2 197.2 120.1 141.1 157.2      119.1 194.2 213.2 167.2 187.2 141.2 143.1  157.2 141.1 185.2 173.2 239.2
##   REN145.P07  G10B  MU23  G10H Sex.1
## 1      157.2 156.2 203.2 239.2     F
## 2      157.2 156.2 187.2 241.3     F
## 3      157.2 156.2 189.2 241.3     F
## 4      157.2 158.2 189.2 241.3     F
## 5      159.2 156.2 187.2 241.2     M
## 6      159.2 156.2 203.2 241.3     F
</code></pre>

<pre><code class="r">  samps&lt;-read.csv(&quot;../data/samples.csv&quot;)
  head(samps)
</code></pre>

<pre><code>##       Sample Lab.ID  Class Individual Bundle.No. Period Event.ID Priority Selected Bear.No.  X X.G X.U Left U.L     Comments X.1 Loci   CXX20     G1D    G10M
## 1    120-1-1    885 sample       0056        130      1   120-01        4        1       NA NA      30    A   L 1st envelope  NA    7 123.137 176.186 214.218
## 2 380-120-03    732 sample       0056        380      1   120-03        3        1       NA NA  10  NA    A   L               NA    7 123.137 176.186 214.218
## 3    120-1-6   1004 sample       0056        254      1   120-06        4        2       NA NA  10  NA    A   L 1st envelope  NA    7 123.137 176.186 214.218
## 4 380-120-07    731 sample       0056        380      1   120-07        2        1       NA NA  10  NA    A   L               NA    7 123.137 176.186 214.218
## 5  20-120-09     20 sample       0056         20      1   120-09        2        3       NA NA      30    A   L 1st envelope  NA   15 123.137 176.186 214.218
## 6  20-120-10     87 sample       0056         20      1   120-10        3        1       NA NA  10  NA    A   U               NA   12 123.137 176.186 214.218
##     MSUT2    MU50    G10X    G10P REN144.A06   G1A G10C   D1A    G10J    G10L CPH9 CXX110  D123 MU26 G10U    MU59 REN145.P07 G10B  MU23  G10H   Sex
## 1 205.207 134.136 133.147                 NA    NA   NA    NA                   NA     NA    NA   NA   NA                 NA   NA    NA    NA 250.2
## 2 205.207 134.136 133.147                 NA    NA   NA    NA                   NA     NA    NA   NA   NA                 NA   NA    NA    NA 250.2
## 3 205.207 134.136 133.147                 NA    NA   NA    NA                   NA     NA    NA   NA   NA                 NA   NA    NA    NA 250.2
## 4 205.207 134.136 133.147                 NA    NA   NA    NA                   NA     NA    NA   NA   NA                 NA   NA    NA    NA 250.2
## 5 205.207 134.136 133.147              129.1 194.2   NA 157.2 207.211 137.159   NA     NA 141.1   NA   NA                 NA   NA 203.2 239.2 250.2
## 6 205.207 134.136 133.147 163.163         NA    NA   NA    NA 207.211 137.159   NA     NA    NA   NA   NA 233.237         NA   NA    NA 239.2 250.2
</code></pre>

<p>Data quality check:  compare number of samples on the &ldquo;individuals&rdquo; and &ldquo;samples&rdquo; tabs of Karen&#39;s Excel file.  This looks good (the two agree!).</p>

<pre><code class="r">  no.samps&lt;-table(samps$Individual)
  dat.no&lt;-data.frame(names(no.samps),no.samps)[,-2]
  alldat&lt;-merge(ind, dat.no, by.x=&quot;Individual&quot;, by.y=&quot;names.no.samps.&quot;, all=TRUE )
  summary(alldat$Freq- alldat$no_Samples) # Looks good
</code></pre>

<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA&#39;s 
##       0       0       0       0       0       0       3
</code></pre>

<p>Look at event IDs &amp; Periods. Use strsplit to determine the site associated with each sample </p>

<pre><code class="r">   events&lt;-unlist(strsplit(as.character(samps$Event.ID), &quot;-&quot;))
   samps$site&lt;-as.numeric(sapply(strsplit(as.character(samps$Event.ID), &quot;-&quot;), `[`, 1))
   samps$cid&lt;-as.numeric(sapply(strsplit(as.character(samps$Event.ID), &quot;-&quot;), `[`, 2))
</code></pre>

<pre><code>## Warning: NAs introduced by coercion
</code></pre>

<pre><code class="r">   table(samps$site)
</code></pre>

<pre><code>## 
##   1   2   3   4   5   7   8   9  10  11  12  13  14  15  16  17  18  19  20  21  22  23  24  25  26  27  28  29  32  33  34  35  36  38  39  40  41  42  45  46 
##  11  18   2  14  15   2  10   1  27  21   1   1  28  29  28   8  18   1   7  20  29  13   9   7  33  25  17  13   4  25  34  18  26   6   8   1  12  16  18  35 
##  48  49  50  51  52  53  54  55  56  57  59  60  61  62  63  64  66  67  69  70  71  72  73  74  75  77  78  80  81  82  83  84  85  86  87  88  89  90  91  92 
##   9   6  23   4   8   8   1  21  22   7  10  30   4  29   1  11  12  20  17   1  26  20  12   9  26  11   7   1   4   2  21   6  11  20  17  12  20  20  16  17 
##  93  94  95  96  98  99 100 101 102 103 104 105 106 107 108 109 113 114 115 116 117 118 119 120 121 
##  10   7   5  21  14  15  24  10   7  18  10  12  22   4  12   9   9  23   5   1   6   2   8  38  18
</code></pre>

<pre><code class="r">  # samps$Per.check&lt;-substr(samps$cid,1,1) # thought might be period, but it is not
  # table(samps$Per.Check, samps$Period)
</code></pre>

<p>Note, there are several observations that are missing the sample Period.  A few of these appear to be samples
of collared bears (these should be dropped, correct?).  Many of the missing observations have 
Class = Xsubselect (not sent to lab?).  Two correspond to sampled observations with a non-missing Priority, so these 
probably(?) represent data entry errors that should be fixed.</p>

<p>I will write all observations that are missing a value for Period out ot a file for later checking.  The code, below, also highlights
three observations that should probably be given higher priority for checking.</p>

<pre><code class="r">  filter(samps, Period==&quot;&quot;, Lab.ID%in%c(26, 93, 1031))[,c(1:9, 16,18, 42, 43)]  
</code></pre>

<pre><code>##     Sample Lab.ID  Class Individual Bundle.No. Period Event.ID Priority Selected     Comments Loci   Sex site
## 1 26-67-01     26 sample   25-55-01         26           67-01        1        1 1st envelope   12 204.2   67
## 2 26-33-04     93 sample    7-34-11         26           33-04        2        1                 9 204.2   33
## 3 26-46-09   1031  Xbomb                    26           46-09        3        2                 6 204.2   46
</code></pre>

<pre><code class="r">  miss.period&lt;-filter(samps, Period==&quot;&quot;)[,c(1:9, 16,18, 42, 43)]
  write.csv(miss.period, file=&quot;../data/MissingPeriod.csv&quot;, row.names=FALSE) 
</code></pre>

<p>Update:  7/10/2015:  using a file named &ldquo;Subsampling Minnesota bear hair_boxes 1 and 2.xls&rdquo; file in directory, 
C:\Users\jfieberg\Documents\MNDNR\Grand Rapids\Bear Group\DNA hair sampling\draft instructions plan, we were able to determine the period for
3 of these observations.  The code, below, will impute these values.</p>

<pre><code class="r">  samps$Period[samps$Event.ID==&quot;67-01&quot; &amp; samps$Period==&quot;&quot;]&lt;-1
  samps$Period[samps$Event.ID==&quot;33-04&quot; &amp; samps$Period==&quot;&quot;]&lt;-5
  samps$Period[samps$Event.ID==&quot;46-09&quot; &amp; samps$Period==&quot;&quot;]&lt;-3
</code></pre>

<p>Lets look at the variable labeled <strong>Class</strong>.  I&#39;m not sure what all of these categories are, but I will take a guess, below:</p>

<ul>
<li>sample (sent to lab &amp; processed without any problems)?</li>
<li>xbomb (not sure) are these samples that were difficult to extract DNA from?</li>
<li>Xinadequate (sent to lab, but sample was not adequate)</li>
<li>Xmixed (sent to lab, processed, contained a mixture of hair from different individuals)</li>
<li>Xnotsent (not sent, we&#39;ll see why, below)</li>
<li>Xspecies (sent to lab, processed, but not black bear hair)</li>
<li>Xsubselect (low priority, ran out of money before could process)</li>
</ul>

<p>Number of each type</p>

<pre><code class="r">  table(samps$Class)
</code></pre>

<pre><code>## 
##                  sample       Xbomb Xinadequate      Xmixed    Xnotsent    Xspecies  Xsubselect 
##           1        1026          80         112          14           4           9         396
</code></pre>

<p>Lets look at a few of these categories.  </p>

<p><strong>Xbomb</strong>:  <strong>Individual</strong> is missing for all of the Xbomb observations, and priority is as high as 1. So,
my guess is that an attempt was made to process these samples, but they were problematic in some way.</p>

<pre><code class="r">  filter(samps, Class==&quot;Xbomb&quot;)[,c(1:9, 16,18)]  
</code></pre>

<pre><code>##        Sample Lab.ID Class Individual Bundle.No. Period Event.ID Priority Selected                                         Comments Loci
## 1   23-100-10     92 Xbomb                    23      1   100-10        3        1                                                     1
## 2   331-14-03    638 Xbomb                   331      1    14-03        2       NA                                                     6
## 3     3-14-06   1099 Xbomb                     3      1    14-06        3        3                                     2nd envelope    3
## 4     4-15-01      4 Xbomb                     4      1    15-01        2       NA                                                     1
## 5    15-22-01     15 Xbomb                    15      1    22-01        1        1               maybe not bear? uf brown and white    2
## 6     5-26-18     70 Xbomb                     5      1    26-18        3        1                                                     3
## 7     9-39-01      9 Xbomb                     9      1    39-01        1        1                                                     0
## 8     8-40-01      8 Xbomb                     8      1    40-01        1        1                                                     0
## 9     7-52-02      7 Xbomb                     7      1    52-02        1        1                                  maybe not bear?    0
## 10   21-70-01     21 Xbomb                    21      1    70-01        1        1               maybe not bear? roots looked weird    1
## 11    2-71-02   1029 Xbomb                     2      1    71-02        3        2                                       dirty hair    0
## 12   22-80-01     22 Xbomb                    22      1    80-01        1        1                                                     3
## 13   57-88-01   1101 Xbomb                    57      1    88-01        2        3                                                     2
## 14  382-88-05    736 Xbomb                   382      1    88-05        1        1                                     1st envelope    1
## 15   27-88-06     27 Xbomb                    27      1    88-06        3        1                                                     1
## 16     16-1-1    794 Xbomb                    33      1                 4        1                                     1st envelope    2
## 17     26-1-1    883 Xbomb                   128      1                 4        1                                                     3
## 18     26-1-2    944 Xbomb                   193      1                 4        1                                     1st envelope    2
## 19    26-1-22    968 Xbomb                   217      1                 4        1                                     1st envelope    2
## 20     26-1-5    985 Xbomb                   235      1                 4        2                                     1st envelope    6
## 21  73-107-01    156 Xbomb                    73      2   107-01        1        1 blonde underfur, kind of weird, not sure if bear    2
## 22  67-114-03    145 Xbomb                    67      2   114-03        3        1                               roots looked weird    1
## 23  72-119-06    155 Xbomb                    72      2   119-06        3        1                                     1st envelope    2
## 24  384-36-03    740 Xbomb                   384      2    36-03        3        1                                     1st envelope    3
## 25   37-45-01     37 Xbomb                    37      2    45-01        1        1                                                     1
## 26   55-49-02    126 Xbomb                    55      2    49-02        2        1                                     1st envelope    4
## 27   48-52-01     48 Xbomb                    48      2    52-01        1        1                                                     1
## 28   54-62-02    125 Xbomb                    54      2    62-02        3        1                                     1st envelope    6
## 29   91-90-04    196 Xbomb                    91      2    90-04        1        1                                                     0
## 30    119-2-1    803 Xbomb                    43      2                 4        1                                                     6
## 31    26-2-10    830 Xbomb                    70      2                 4        1                                     1st envelope    1
## 32     77-2-2    921 Xbomb                   168      2                 4        1                                                     2
## 33     84-2-2    978 Xbomb                   228      2                 4        1                                                     2
## 34    108-2-4    986 Xbomb                   236      2                 4        2                                                     2
## 35    26-2-11   1022 Xbomb                   273      2                 4        2                    coarse underfur, 1st envelope    0
## 36 131-103-01    276 Xbomb                   131      3   103-01        3        1                                                     1
## 37 131-103-02    275 Xbomb                   131      3   103-02        2        1                                 not sure if bear    1
## 38 130-114-02    272 Xbomb                   130      3   114-02        2        1                                                     5
## 39  127-17-02    268 Xbomb                   127      3    17-02        1        1                                                     6
## 40  111-19-01    234 Xbomb                   111      3    19-01        1        1                                                     3
## 41  117-50-06   1046 Xbomb                   117      3    50-06        3        2                                                     3
## 42  155-77-01    319 Xbomb                   155      3    77-01        2        1                                     1st envelope    1
## 43     92-3-2    818 Xbomb                    58      3                 4        1                                                     0
## 44     29-3-2    888 Xbomb                   133      3                 4        1                                                     2
## 45     14-3-7   1003 Xbomb                   253      3                 4        2                                                     2
## 46 203-113-02    408 Xbomb                   203      4   113-02        1        1                                                     5
## 47 202-120-04    407 Xbomb                   202      4   120-04        3        1                                                     1
## 48  194-16-02   1058 Xbomb                   194      4    16-02        2        2                                                     6
## 49  166-45-01    337 Xbomb                   166      4    45-01        2        2                                                     1
## 50  182-51-01    371 Xbomb                   182      4    51-01        2        1                                                     1
## 51  179-52-04    366 Xbomb                   179      4    52-04        2        1                                  maybe not bear?    2
## 52  160-57-01    327 Xbomb                   160      4    57-01        1        1                                                     0
## 53  160-57-03    328 Xbomb                   160      4    57-03        3        1                                  maybe not bear?    2
## 54  218-93-05    435 Xbomb                   218      4    93-05        3        1                                                     3
## 55     86-4-7    782 Xbomb                    21      4                 4        1                                                     2
## 56     28-4-5    788 Xbomb                    27      4                 4        1                                                     3
## 57     36-4-4    853 Xbomb                    95      4                 4        1                       coarse underfur, not bear?    2
## 58  330-22-04    636 Xbomb                   330      5    22-04        2       NA                                                     4
## 59  248-36-02    494 Xbomb                   248      5    36-02        1        1                                                     2
## 60  257-39-05    509 Xbomb                   257      5    39-05        3        1                                                     1
## 61  305-42-02    595 Xbomb                   305      5    42-02        3        1                                                     0
## 62  243-45-04    484 Xbomb                   243      5    45-04        1        1                                                     1
## 63  265-50-01    524 Xbomb                   265      5    50-01        1        1                                                     1
## 64  268-62-04    528 Xbomb                   268      5    62-04        1        1                                                     3
## 65  241-71-05   1111 Xbomb                   241      5    71-05        3        3                                  maybe not bear?    2
## 66  297-82-01    580 Xbomb                   297      5    82-01        1        1                                     2nd envelope    2
## 67  256-87-01    507 Xbomb                   256      5    87-01        2        1                                                     4
## 68     56-5-9    822 Xbomb                    62      5                 4        1                                     2nd envelope    1
## 69     50-5-8    933 Xbomb                   181      5                 4        1                                                     6
## 70     71-5-1   1017 Xbomb                   268      5                 4        2                                  coarse underfur    6
## 71  344-16-01    667 Xbomb                   344      6    16-01        1        1                                                     0
## 72  321-34-02    622 Xbomb                   321      6    34-02        2        1                                                     4
## 73  314-45-02    607 Xbomb                   314      6    45-02        3        1                                                     6
## 74  336-50-03    649 Xbomb                   336      6    50-03        1        1                                                     2
## 75  318-59-01    614 Xbomb                   318      6    59-01        1        1                                                     1
## 76  315-69-01    608 Xbomb                   315      6    69-01        1        1                                                     0
## 77  338-75-04    654 Xbomb                   338      6    75-04        3        1                                                     1
## 78   349-8-01    673 Xbomb                   349      6     8-01        1        1                                                     3
## 79  337-86-03   1086 Xbomb                   337      6    86-03        2        2                                                     6
## 80   26-46-09   1031 Xbomb                    26      3    46-09        3        2                                                     6
</code></pre>

<p><strong>Xinadequate</strong>: similar story&hellip;not sure how this category differs from <strong>xbomb</strong> though?</p>

<pre><code class="r">  filter(samps, Class==&quot;Xinadequate&quot;)[,c(1:9, 16,18)]  
</code></pre>

<pre><code>##         Sample Lab.ID       Class Individual Bundle.No. Period Event.ID Priority Selected                              Comments Loci
## 1    23-100-02     NA Xinadequate                    23      1   100-02        2        1                     no roots on hairs    0
## 2    19-113-01     NA Xinadequate                    19      1   113-01        1        1                              no roots    0
## 3    20-120-04     NA Xinadequate                    20      1   120-04        1        1                                 &lt;5 uf    0
## 4      4-15-02     NA Xinadequate                     4      1    15-02        1        1                           just shafts    0
## 5     14-16-03     NA Xinadequate                    14      1    16-03        1        1                     no roots on hairs    0
## 6    378-71-07     NA Xinadequate                   378      1    71-07        2        1  neither envelope had sufficient hair    0
## 7      18-8-02     NA Xinadequate                    18      1     8-02        3        1               2 hairs - dubious roots    0
## 8      6-87-03     NA Xinadequate                     6      1    87-03        1        1                     only one uf  root    0
## 9     27-88-02     NA Xinadequate                    27      1    88-02        2        1                                          0
## 10   382-88-03     NA Xinadequate                   382      1    88-03        2        1                              no roots    0
## 11    27-88-04     NA Xinadequate                    27      1    88-04        1        1                &lt;5 uf in each envelope    0
## 12    30-91-02     NA Xinadequate                    30      1    91-02        2        2                               &lt; 20 uf    0
## 13      4-2-04     NA Xinadequate                     4      2     2-04        3        1                                  2 gh    0
## 14    41-26-01     NA Xinadequate                    41      2    26-01        2        1                     no roots on hairs    0
## 15    39-36-07     NA Xinadequate                    39      2    36-07        2        1                                &lt;20 uf    0
## 16    79-84-05     NA Xinadequate                    79      2    84-05        1        1                     no roots on hairs    0
## 17    70-99-02     NA Xinadequate                    70      2    99-02        1        1                                  1 gh    0
## 18    122-1-01     NA Xinadequate                   122      3     1-01        1        1                                  5 uf    0
## 19  135-108-05     NA Xinadequate                   135      3   108-05        2        1                     no roots on hairs    0
## 20  137-109-06     NA Xinadequate                   137      3   109-06        1        1                                &lt;20 uf    0
## 21   129-11-06     NA Xinadequate                   129      3    11-06        1        1                                  1 gh    0
## 22   102-26-01     NA Xinadequate                   102      3    26-01        1        1                                1 hair    0
## 23   112-29-04     NA Xinadequate                   112      3    29-04        2        2                             &lt; 5 hairs    0
## 24   150-42-01     NA Xinadequate                   150      3    42-01        2       NA      both envelopes had too few hairs    0
## 25   150-42-03     NA Xinadequate                   150      3    42-03        1        1                     no roots on hairs    0
## 26   151-56-02     NA Xinadequate                   151      3    56-02        2        2                      not enough hairs    0
## 27   151-56-07     NA Xinadequate                   151      3    56-07        3       NA                     no roots on hairs    0
## 28   151-56-08     NA Xinadequate                   151      3    56-08        1        1      both envelopes had too few hairs    0
## 29   142-61-01     NA Xinadequate                   142      3    61-01        1        1                          1 guard hair    0
## 30   149-72-01     NA Xinadequate                   149      3    72-01        1        1                                1 hair    0
## 31   143-73-01     NA Xinadequate                   143      3    73-01        1        1                                 ~5 uf    0
## 32   155-77-02     NA Xinadequate                   155      3    77-02        1        1                                 &lt;5 uf    0
## 33   351-83-03     NA Xinadequate                   351      3    83-03        3        2                                1 root    0
## 34   148-83-06     NA Xinadequate                   148      3    83-06        3        1                                 &lt;20uf    0
## 35   148-83-07     NA Xinadequate                   148      3    83-07        1        1              both envelopes had &lt;20uf    0
## 36   390-83-10     NA Xinadequate                   390      3    83-10        1        1  neither envelope has sufficient hair    0
## 37   145-84-01     NA Xinadequate                   145      3    84-01        1        1           neither envelope had enough    0
## 38   312-85-02     NA Xinadequate                   312      3    85-02        3        2                                &lt;20 uf    0
## 39   147-94-01     NA Xinadequate                   147      3    94-01        2        1   only 3 hairs, probably Xspecies too    0
## 40      55-3-8     NA Xinadequate                   221      3                 4        1                               2 roots    0
## 41  207-106-09     NA Xinadequate                   207      4   106-09        2        1                                 &lt;5 uf    0
## 42  215-117-01     NA Xinadequate                   215      4   117-01        1        1                                          0
## 43  215-117-03     NA Xinadequate                   215      4   117-03        2        1                                          0
## 44  212-119-05     NA Xinadequate                   212      4   119-05        2        1                               3 hairs    0
## 45  281-120-06     NA Xinadequate                   281      4   120-06        3        1                                1 hair    0
## 46   48-120-07     NA Xinadequate                    48      4   120-07        3        3                                &lt;20 uf    0
## 47   188-18-02     NA Xinadequate                   188      4    18-02        2        1          envelope appears to be empty    0
## 48   190-28-01     NA Xinadequate                   190      4    28-01        2        2                                 &lt;20uf    0
## 49   166-45-06     NA Xinadequate                   166      4    45-06        1        1                              &lt;5 hairs    0
## 50   181-50-03     NA Xinadequate                   181      4    50-03        3        1                              &lt;5 hairs    0
## 51   181-50-06     NA Xinadequate                   181      4    50-06        1        1                               2 hairs    0
## 52   182-51-02     NA Xinadequate                   182      4    51-02        1        1                               2 hairs    0
## 53   227-56-02     NA Xinadequate                   227      4    56-02        1        1                    2 hairs with roots    0
## 54   183-62-01     NA Xinadequate                   183      4    62-01        1        1                                 &lt;20uf    0
## 55   184-63-01     NA Xinadequate                   184      4    63-01        1        1 both samples didn’t have enough hairs    0
## 56   159-69-01     NA Xinadequate                   159      4    69-01        1        1                         too few hairs    0
## 57   159-69-02     NA Xinadequate                   159      4    69-02        3       NA                         too few hairs    0
## 58   159-69-04     NA Xinadequate                   159      4    69-04        2        1                         too few hairs    0
## 59   111-72-03     NA Xinadequate                   111      4    72-03        2        2            &lt;5 hairs in both envelopes    0
## 60   185-74-01     NA Xinadequate                   185      4    74-01        1        1                only a couple of hairs    0
## 61   186-75-02     NA Xinadequate                   186      4    75-02        3        1                               2 hairs    0
## 62   178-87-01     NA Xinadequate                   178      4    87-01        2        1                                  3 gh    0
## 63   225-94-02     NA Xinadequate                   225      4    94-02        1        1                                 &lt;5 uf    0
## 64   226-95-01     NA Xinadequate                   226      4    95-01        1        1                              &lt;5 hairs    0
## 65      86-4-5     NA Xinadequate                     8      4                 4        1                                1 hair    0
## 66      75-4-8     NA Xinadequate                    19      4                 4        1                              &lt;5 hairs    0
## 67     106-4-7     NA Xinadequate                    84      4                 4        1                               3 roots    0
## 68     119-4-6     NA Xinadequate                    98      4                 4        1                               3 hairs    0
## 69      62-4-7     NA Xinadequate                    99      4                 4        1                              &lt;5 hairs    0
## 70      26-4-1     NA Xinadequate                   112      4                 4        1                              &lt;5 hairs    0
## 71      27-4-1     NA Xinadequate                   142      4                 4        1                                1 hair    0
## 72     120-4-8     NA Xinadequate                   169      4                 4        1                                &lt;20 uf    0
## 73      52-4-2     NA Xinadequate                   264      4                 4        2                                &lt;20 uf    0
## 74  284-108-02     NA Xinadequate                   284      5   108-02        2        2                               2 hairs    0
## 75   255-16-03     NA Xinadequate                   255      5    16-03        1        1                               2 hairs    0
## 76   254-18-01     NA Xinadequate                   254      5    18-01        2        1                               3 hairs    0
## 77   262-27-01     NA Xinadequate                   262      5    27-01        1        1                                &lt;20 uf    0
## 78   262-27-02     NA Xinadequate                   262      5    27-02        2        2                               3 roots    0
## 79   258-29-02     NA Xinadequate                   258      5    29-02        2        1                               2 roots    0
## 80   257-39-01     NA Xinadequate                   257      5    39-01        1        1                                  3 uf    0
## 81   302-41-04     NA Xinadequate                   302      5    41-04        1        1            &lt; 5 uf envelope says 41-14    0
## 82    35-56-04     NA Xinadequate                    35      5    56-04        3        1                                &lt;5 uf     0
## 83   311-56-08     NA Xinadequate                   311      5    56-08        1        1                                  &lt;5uf    0
## 84   268-62-01     NA Xinadequate                   268      5    62-01        2        1                             &lt; 5 hairs    0
## 85   313-77-01     NA Xinadequate                   313      5    77-01        2        1                                  &lt;5uf    0
## 86   313-77-02     NA Xinadequate                   313      5    77-02        1        1                                  &lt;5uf    0
## 87   266-86-01     NA Xinadequate                   266      5    86-01        1        1                                  &lt;5uf    0
## 88   256-87-02     NA Xinadequate                   256      5    87-02        3        1                                  5 uf    0
## 89   312-88-01     NA Xinadequate                   312      5    88-01        1        1   less than 5 roots in both envelopes    0
## 90   307-89-02     NA Xinadequate                   307      5    89-02        2        1                                  &lt;5uf    0
## 91   307-89-04     NA Xinadequate                   307      5    89-04        3        1                               2 roots    0
## 92   306-91-04     NA Xinadequate                   306      5    91-04        1        1                                  &lt;5uf    0
## 93   290-93-02     NA Xinadequate                   290      5    93-02        1        1                                 &lt;5 uf    0
## 94   283-98-03     NA Xinadequate                   283      5    98-03        1        1                               2 roots    0
## 95      16-5-1     NA Xinadequate                    38      5                 4        1                               3 roots    0
## 96      89-5-3     NA Xinadequate                    74      5                 4        1                                &lt;20 uf    0
## 97      56-5-2     NA Xinadequate                   152      5                 4        1                                          0
## 98      67-5-3     NA Xinadequate                   192      5                 4        1                               &lt; 20 uf    0
## 99    348-1-01     NA Xinadequate                   348      6     1-01        1        1                               2 roots    0
## 100 377-120-02     NA Xinadequate                   377      6   120-02        2        1                                1 root    0
## 101  343-17-03     NA Xinadequate                   343      6    17-03        2        1                               3 hairs    0
## 102  345-18-01     NA Xinadequate                   345      6    18-01        1        1                             1 gh 5 uf    0
## 103  345-18-02     NA Xinadequate                   345      6    18-02        2        1                                 &lt;5 uf    0
## 104  329-39-01     NA Xinadequate                   329      6    39-01        1        1                               3 hairs    0
## 105  351-55-01     NA Xinadequate                   351      6    55-01        1        1                               2 hairs    0
## 106  357-66-01     NA Xinadequate                   357      6    66-01        2        1                               3 hairs    0
## 107  366-73-01     NA Xinadequate                   366      6    73-01        1        1                               4 hairs    0
## 108  366-73-03     NA Xinadequate                   366      6    73-03        3        1           both envelopes had &lt;4 hairs    0
## 109  339-74-01     NA Xinadequate                   339      6    74-01        1        1                               3 hairs    0
## 110  330-87-01     NA Xinadequate                   330      6    87-01        1        1                                 &lt;10uf    0
## 111  354-89-01     NA Xinadequate                   354      6    89-01        1        1                               2 hairs    0
## 112  368-93-03     NA Xinadequate                   368      6    93-03        1        1                              &lt;5 hairs    0
</code></pre>

<p><strong>Xmixed</strong>:  similar story&hellip;</p>

<pre><code class="r">  filter(samps, Class==&quot;Xmixed&quot;)[,c(1:9, 16,18)]  
</code></pre>

<pre><code>##        Sample Lab.ID  Class Individual Bundle.No. Period Event.ID Priority Selected                                                              Comments Loci
## 1    50-50-02    123 Xmixed                    50      2    50-02        3        1                                                                          2
## 2    54-62-05     54 Xmixed                    54      2    62-05        1        1                                                     kinky guard hairs    1
## 3  138-106-04    290 Xmixed                   138      3   106-04        3        1 different ID in second spreadsheet - (10-4) - envelope actually 106-4    3
## 4  207-106-10    416 Xmixed                   207      4   106-10        1        1                                                                          1
## 5   145-60-12    302 Xmixed                   145      4    60-12        2        1                                                                          2
## 6   177-64-01    362 Xmixed                   177      4    64-01        2        1                                                                          0
## 7      34-4-6    798 Xmixed                    37      4                 4        1                                                                          1
## 8      86-4-8    826 Xmixed                    66      4                 4        1                                                          1st envelope    0
## 9   246-14-02    489 Xmixed                   246      5    14-02        1        1                                                                          2
## 10  300-21-05    587 Xmixed                   300      5    21-05        3        1                                                                          0
## 11  348-50-03    671 Xmixed                   348      5    50-03        2       NA                                                                          0
## 12 377-120-05    728 Xmixed                   377      6   120-05        1        1                                                          1st envelope    1
## 13  334-27-02    645 Xmixed                   334      6    27-02        2        1                                                                          0
## 14  357-66-02    690 Xmixed                   357      6    66-02        1        1                                                                          1
</code></pre>

<p><strong>Xnotsent</strong>:  Looks like these observations correspond to mislabeled / misbundled envelopes.  Only 4 of these. </p>

<pre><code class="r">  filter(samps, Class==&quot;Xnotsent&quot;)[,c(1:9, 16,18)]  
</code></pre>

<pre><code>##      Sample Lab.ID    Class Individual Bundle.No. Period Event.ID Priority Selected                                                      Comments Loci
## 1 68-121-02     NA Xnotsent                    68      2   121-02        1        1                        no envelope with this number in bundle    0
## 2 354-89-02     NA Xnotsent                   354      3    89-02        2        1                                           not found in bundle    0
## 3 393-33-02     NA Xnotsent                   393      4    33-02        3        1 envelope actually in bundle - 33-03 (should be in bundle 244)    0
## 4 326-25-04     NA Xnotsent                   326      6    25-04        2        1    This sample not included in bundle (25-01 present instead)    0
</code></pre>

<p><strong>Xspecies</strong>:  hair likely from different species</p>

<pre><code class="r">  filter(samps, Class==&quot;Xspecies&quot;)[,c(1:9, 16,18)]  
</code></pre>

<pre><code>##      Sample Lab.ID    Class Individual Bundle.No. Period Event.ID Priority Selected                                           Comments Loci
## 1   7-52-01     NA Xspecies                     7      1    52-01        2        1                              not bear, banded hair    0
## 2  24-66-04     NA Xspecies                    24      1    66-04        3        1                      banded hairs, all 3 envelopes    0
## 3   16-7-01     NA Xspecies                    16      1     7-01        1        1 samples appeared to be ungulate hair (4 envelopes)    0
## 4 104-25-03     NA Xspecies                   104      3    25-03        1        1                                        banded hair    0
## 5 119-27-03     NA Xspecies                   119      3    27-03        3        1                                        banded hair    0
## 6 110-39-01     NA Xspecies                   110      3    39-01        1        1                                        banded hair    0
## 7 109-52-01     NA Xspecies                   109      3    52-01        1        1                                        banded hair    0
## 8 263-49-01     NA Xspecies                   263      5    49-01        3        1                                        banded hair    0
## 9 331-52-01     NA Xspecies                   331      6    52-01        1        1                                       banded hairs    0
</code></pre>

<p><strong>Xsubselect</strong>:  some of these are high priority (so, not sure why they fell to end of list? maybe they were alternates for other
samples collected at the same site &amp; period?). Show only the first 10 observations.</p>

<pre><code class="r">  filter(samps, Class==&quot;Xsubselect&quot;)[1:10,c(1:9, 16)]  
</code></pre>

<pre><code>##        Sample Lab.ID      Class Individual Bundle.No. Period Event.ID Priority Selected Comments
## 1  308-100-01     NA Xsubselect                   308      1   100-01        3       NA         
## 2  380-120-13     NA Xsubselect                   380      1   120-13        1       NA         
## 3   373-16-02     NA Xsubselect                   373      1    16-02        3       NA         
## 4    15-22-03     NA Xsubselect                    15      1    22-03        2       NA         
## 5     5-26-24     NA Xsubselect                     5      1    26-24        2       NA         
## 6   379-62-02     NA Xsubselect                   379      1    62-02        1       NA         
## 7   379-62-03     NA Xsubselect                   379      1    62-03        2       NA         
## 8     1-69-03     NA Xsubselect                     1      1    69-03        2       NA         
## 9   249-71-03     NA Xsubselect                   249      1    71-03        2       NA         
## 10  378-71-04     NA Xsubselect                   378      1    71-04        3       NA
</code></pre>

<h3>Subsetting of the data</h3>

<p>At this point, I think it makes to subset the data, creating 4 separate data sets:</p>

<ol>
<li>Samples that were processed without any problems (Class = sample).<br/></li>
<li>Samples that were sent, but turned out to be problematic (Class = Xbomb, Xinadequate, Xmixed)</li>
<li>Samples that likely did not represent bear hair (Class = Xnotsent, Xspecies)</li>
<li><p>Samples that were not processed (Xsubselect)</p>

<p>We will focus mostly on [1] going forward, but the other data sets may still prove useful, particularly if /
when we try to construct a reasonable simulation model.</p></li>
</ol>

<pre><code class="r">  sampobs&lt;-filter(samps, Class==&quot;sample&quot;)
  samp.prob&lt;-filter(samps, Class%in%c(&quot;Xbomb&quot;, &quot;Xinadequate&quot;, &quot;Xmixed&quot;))
  samp.nobhair&lt;-filter(samps, Class%in%c(&quot;Xnotsent&quot;, &quot;Xspecies&quot;))
  samp.noprocess&lt;-filter(samps, Class==&quot;Xsubselect&quot;)
</code></pre>

<h3>Further exploration of Sampled Observations</h3>

<p>At least 2 observations with Period = &ldquo;?6&rdquo;.  Look at these:</p>

<pre><code class="r">  filter(sampobs, Period==&quot;6?&quot;)
</code></pre>

<pre><code>##      Sample Lab.ID  Class Individual Bundle.No. Period Event.ID Priority Selected Bear.No.  X X.G X.U Left U.L     Comments X.1 Loci   CXX20     G1D    G10M
## 1 365-85-01    704 sample   10-86-01        365     6?    85-01        1        1       NA NA   2  20    C   L               NA    7 123.135 176.176 208.214
## 2 364-96-03    702 sample   31-60-03        364     6?    96-03        1        1       NA NA  10  NA    A   L 1st envelope  NA    7 141.145 186.186 206.218
##     MSUT2    MU50    G10X G10P REN144.A06 G1A G10C D1A G10J G10L CPH9 CXX110 D123 MU26 G10U MU59 REN145.P07 G10B MU23 G10H   Sex site cid
## 1 197.207 130.138 141.151              NA  NA   NA  NA             NA     NA   NA   NA   NA              NA   NA   NA   NA 204.2   85   1
## 2 197.201 134.140 151.153              NA  NA   NA  NA             NA     NA   NA   NA   NA              NA   NA   NA   NA 204.2   96   3
</code></pre>

<p>Fix these, then turn this variable into a numeric variable</p>

<pre><code class="r">  sampobs$Period[sampobs$Period==&quot;6?&quot;]&lt;-&quot;6&quot;
</code></pre>

<p>For now, drop observations that are missing Period.  Eventually, however, we will want to reconcile two of these 
observations that were highlighted earlier. The remaining 7 of these 9 observations correspond to observations from collared bears. </p>

<pre><code class="r">  sampobs2&lt;-filter(sampobs, Period!=&quot;&quot;)
</code></pre>

<p>Now, turn Period into a numeric variable  </p>

<pre><code class="r">  sampobs2$Period&lt;-droplevels(sampobs2$Period)  
  sampobs2$Period&lt;-as.numeric(sampobs2$Period)
  table(sampobs2$Period)
</code></pre>

<pre><code>## 
##   1   2   3   4   5   6 
##  78 209 175 235 182 140
</code></pre>

<p>Drop several of the columns that we will not need. </p>

<pre><code class="r">  sampobs3&lt;-sampobs2[,c(1:9, 16,18,42:44)] 
</code></pre>

<p>Write this file out for later use</p>

<pre><code class="r">   write.csv(sampobs3, file=&quot;../data/samps1.csv&quot;, row.names=FALSE)  
</code></pre>

</body>

</html>
