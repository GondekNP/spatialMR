{
    "contents" : "\nBearSubParallelSECR<- function(subtype, iterNo, size=450) {\n  source('~/Google Drive/spatialMR/Rscripts/BearParallelModelFit.R')\n  source('~/Google Drive/spatialMR/Rscripts/BearSubsample.R')\n  source('~/Google Drive/spatialMR/Rscripts/BearSumFunc.R')\n  \n  #'Loading necessary libraries.\n  \n  library(dplyr) \n  library(secr) \n  library(secrdesign)\n  library(scrbook)\n  library(ggplot2)\n  library(mosaic)\n  \n  #' Read in raw data on samples and individuals tab (saved as .csv files)\n  ind<-read.csv(\"../data/Individuals2.csv\")\n  head(ind)\n  \n  samps<-read.csv(\"../data/samplesCorrected.csv\")\n  head(samps)\n  \n  #' Note: on July 23, David sent a file with corrections made to a few observations that were missing period\n  #' or had period=\"6?\".  This program uses the corrected \"samples\" tab from that spreadsheet.  This is the \n  #' main difference from the DataExploration.R file.\n  #'    \n  \n  #' Look at event IDs & Periods. Use strsplit to determine the site associated with each sample \n  \n  events<-unlist(strsplit(as.character(samps$Event.ID), \"-\"))\n  samps$site<-as.numeric(sapply(strsplit(as.character(samps$Event.ID), \"-\"), `[`, 1))\nsuppressWarnings(samps$cid<-as.numeric(sapply(strsplit(as.character(samps$Event.ID), \"-\"), `[`, 2)))\n  table(samps$site)\n  # samps$Per.check<-substr(samps$cid,1,1) # thought might be period, but it is not\n  # table(samps$Per.Check, samps$Period)\n  \n  #' Focus only on observations that were sampled successfully.\n  sampobs<-filter(samps, Class==\"sample\")\n  \n  #' Fix the 6? entries, turn this variable into a numeric variable\n  sampobs$Period[sampobs$Period==\"6?\"]<-\"6\"\n  \n  #' For now, drop observations that are missing Period.  Eventually, however, we will want to reconcile two of these \n  #' observations that were highlighted earlier. The remaining 7 of these 9 observations correspond to observations from collared bears. \n  sampobs<-filter(sampobs, Period!=\"\")\n  \n  #' Subsampling of the sampobs data.\n  sampobs2 <- BearSubsample(sampobs, subtype, size)\n \n  #' NEW 1/14/16 - saving the subsample labID for later use in huggins models, \n  #' that way the same subsample can be reused.\n  if (size==450){\n  write.table(matrix(sampobs2$Lab.ID, 1, size), file = \"../data/SubsamplingData/SubsampleLabID.csv\", sep=\",\", append = TRUE, col.names = FALSE, row.names = FALSE )\n  }\n  if (size!=450){\n    write.table(matrix(sampobs2$Lab.ID, 1, size), file = \"../data/SizeData/SubsampleLabID.csv\", sep=\",\", append = TRUE, col.names = FALSE, row.names = FALSE )\n  }\n  #' Now, turn Period into a numeric variable  \n  #sampobs2$Period<-droplevels(sampobs2$Period)  \n  sampobs2$Period<-as.numeric(sampobs2$Period)\n  table(sampobs2$Period)\n  \n  #' Drop several of the columns that we will not need. \n  sampobs3<-sampobs2[,c(1:9, 16,18,42:44)] \n  \n  #' Setting csv pathways, Write this file out\n  if (size==450){\n  pathcsv1<-paste(\"../data/SubsamplingData/\", subtype, \"/TempSampobs.csv\", sep = \"\")\n  pathcsv2<-paste(\"../data/SubsamplingData/\", subtype, \"/TempCaphist.csv\", sep = \"\")\n  write.csv(sampobs3, file=pathcsv1, row.names=FALSE)\n      }\n  \n  if (size!=450){\n    pathcsv1<-paste(\"../data/SizeData/\", subtype, \"/TempSampobs.csv\", sep = \"\")\n    pathcsv2<-paste(\"../data/SizeData/\", subtype, \"/TempCaphist.csv\", sep = \"\")\n    write.csv(sampobs3, file=pathcsv1, row.names=FALSE)\n      }\n  \n  #' Apply the capture history transformation necessary for secr models\n  BearSumFunc(data=pathcsv1, summary = FALSE, output=pathcsv2)\n  \n  #' Run the model fitting and storage function.\n  BearParallelModelFit(subtype = subtype, iteration=iterNo, size= size)\n  print(paste(subtype,iterNo, \"done!\"))\n}",
    "created" : 1454446669768.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "319351709",
    "id" : "78D7737B",
    "lastKnownWriteTime" : 1454099210,
    "path" : "~/Google Drive/spatialMR/Rscripts/BearSubParallelSECR.R",
    "project_path" : "BearSubParallelSECR.R",
    "properties" : {
    },
    "relative_order" : 4,
    "source_on_save" : false,
    "type" : "r_source"
}